<div style="margin-top: 20px;">
  <a (click)="routeTo('Batch')"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
      class="bi bi-arrow-left-circle-fill" viewBox="0 0 16 16">
      <path
        d="M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0zm3.5 7.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H11.5z" />
    </svg>Back to list</a>
</div>

<h2>Create New Batch</h2>

<form #newBatch="ngForm" (ngSubmit)="NewBatch(newBatch)">
  <div class="container-fluid">
    <div class="row">

      <div class="form-group">
        <label for="code">Book No.</label><br>
        <input #bookNo="ngModel" type="text" class="form-control" id="bookNo" required name="bookNo" ngModel>
        <p *ngIf="bookNo.touched && bookNo.invalid" style="color: red;">please insert valid book number</p>
        <p *ngIf="bookNo.errors?.['required'] && bookNo.touched" style="color: red;">book number is require</p>
      </div>
      <pre></pre>
      <div class="form-group">
        <label for="code">Invoice No.</label><br>
        <input #invoiceNo="ngModel" type="text" class="form-control" id="invoiceNo" name="invoiceNo" ngModel>

      </div>

      <pre></pre>

      <div class="form-group">
        <label for="supplierName">Supplier/Customer Name </label><br>
        <input #supplierName="ngModel" type="text" class="form-control" id="supplierName" required minlength="2"
          maxlength="20" name="supplierName" ngModel>
        <p *ngIf="supplierName.touched && supplierName.invalid" style="color: red;">please insert valid name</p>
        <p *ngIf="supplierName.errors?.['required'] && supplierName.touched" style="color: red;">Name is require</p>
      </div>

      <div class="form-group">
        <label for="inventoryName">Inventory Name </label><br>
        <input #inventoryName="ngModel" type="text" class="form-control" id="inventoryName" required minlength="2"
          maxlength="20" name="inventoryName" ngModel>
        <p *ngIf="inventoryName.touched && inventoryName.invalid" style="color: red;">please insert valid name</p>
        <p *ngIf="inventoryName.errors?.['required'] && inventoryName.touched" style="color: red;">Name is require</p>
      </div>

      <div class="form-group">
        <label for="operationDate">Date </label><br>
        <input #operationDate="ngModel" type="date" class="form-control" id="operationDate" required
          name="operationDate" ngModel>
        <p *ngIf="operationDate.errors?.['required'] && operationDate.touched" style="color: red;">Date is require</p>
      </div>

      <div class="form-group">
        <h5 for="startStock">Operation type</h5><br>



        <svg class="filter" version="1.1">
          <defs>
            <filter id="gooeyness">
              <feGaussianBlur in="SourceGraphic" stdDeviation="8" result="blur" />
              <feColorMatrix in="blur" mode="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 20 -10"
                result="gooey" />
              <feComposite in="SourceGraphic" in2="gooey" operator="atop" />
            </filter>
          </defs>
        </svg>
        <div class="radios-boxes">
          <div class="radios">
            <input type="radio" name="type" id="type1" class="radio" value="0" ngModel #type="ngModel" [value]="0">
            <input type="radio" name="type" id="type2" class="radio" value="1" ngModel #type="ngModel" [value]="1">

            <div class="ball"></div>
          </div>
          <div class="labels">
            <label for="type1" class="label" id="inc">Delivery note</label>
            <label for="type2" class="label" id="dec">Dispose note</label>

          </div>
        </div>
        <p *ngIf="type.touched && type.invalid" style="color: red;">please select brand</p>
        <p *ngIf="type.errors?.['required'] && type.touched" style="color: red;">brand is require</p>
        <!-- <div class="btn-group">
            <input
              mdbRadio
              type="radio"
              class="btn-check"
              name="type"
              id="type1"
              autocomplete="off"
              [checked]="true"
            />
            <label class="btn btn-secondary" for="type1" style="color: rgb(0, 255, 0);">Increase</label>
            <input
              mdbRadio
              type="radio"
              class="btn-check"
              name="type"
              id="type2"
              autocomplete="off"
            />
            <label class="btn btn-secondary" for="type2" style="color: #ff5656;">Decrease</label>


          </div> -->
      </div>
      <div class="form-group">

        <!-- <label for="startStock">Operation type</label><br>
            <select #type="ngModel"  ngModel id="type" name="type" class="form-control" required >

                <option value="0" >Increase</option>
                <option value="1" >Decrease</option>
            </select>
            <p *ngIf="type.touched && type.invalid" style="color: red;">please select brand</p>
            <p *ngIf="type.errors?.['required'] && type.touched" style="color: red;">brand is require</p> -->
      </div>

    </div>
    <br>
    <div class="form-group" style="    background-color: #a5e3fa3b; border-radius: 10px; padding: 10px;">
      <h5 for="startStock">Select Product</h5><br>

      <div class="search_container">

        <div class="container">
          <div class="radio-tile-group">
            <div class="input-container">
              <input id="product" class="radio-button" type="radio" name="isSpare" checked
                (click)="changeSearchIsSpare(false)" />
              <div class="radio-tile">
                <div class="icon product-icon">
                  <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
                    xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 122.88 66.83"
                    style="enable-background:new 0 0 122.88 66.83" xml:space="preserve">
                    <style type="text/css">
                      .st0 {
                        fill-rule: evenodd;
                        clip-rule: evenodd;
                      }
                    </style>
                    <g>
                      <path class="st0"
                        d="M61.7,17.72c9.72-2.36,21.24-2.33,30.28-1.54C84.25,29.95,67.62,28.03,61.7,17.72L61.7,17.72z M25.18,57.6 l-4.13-4.13v5.72C22.58,58.99,23.98,58.43,25.18,57.6L25.18,57.6z M18.3,59.16v-5.68l-4.03,4.03 C15.44,58.35,16.81,58.92,18.3,59.16L18.3,59.16z M12.28,55.6l4.07-4.07h-5.91C10.72,53.04,11.36,54.43,12.28,55.6L12.28,55.6z M10.32,48.77h6.03l-4.41-4.41C11.06,45.64,10.49,47.14,10.32,48.77L10.32,48.77z M13.82,42.34l4.48,4.48v-6.47 C16.62,40.61,15.09,41.31,13.82,42.34L13.82,42.34z M21.06,40.31v6.5l4.58-4.58C24.34,41.22,22.77,40.54,21.06,40.31L21.06,40.31z M27.55,44.23l-4.54,4.54h6.26C29.09,47.08,28.48,45.53,27.55,44.23L27.55,44.23z M29.15,51.52h-6.14l4.2,4.2 C28.17,54.53,28.85,53.09,29.15,51.52L29.15,51.52z M110.91,57.79l-4.31-4.31v5.77C108.18,59.11,109.65,58.59,110.91,57.79 L110.91,57.79z M103.84,59.07v-5.6l-3.84,3.84C101.12,58.16,102.42,58.78,103.84,59.07L103.84,59.07z M98.08,55.33l3.04-3.04 l-4.38,0.4C97.05,53.65,97.51,54.54,98.08,55.33L98.08,55.33z M97.99,44.86l-0.22-0.22l-0.08,0.13L97.99,44.86L97.99,44.86z M99.57,42.55l3.91,3.91c0.11-0.09,0.23-0.18,0.36-0.26v-5.76C102.23,40.77,100.77,41.51,99.57,42.55L99.57,42.55z M106.6,40.26 v5.33c0.33,0.05,0.65,0.14,0.96,0.27l3.82-3.82C110.02,41.05,108.38,40.41,106.6,40.26L106.6,40.26z M113.36,43.96l-3.79,3.79 c0.16,0.32,0.28,0.66,0.34,1.02h5.36C115.09,46.97,114.4,45.32,113.36,43.96L113.36,43.96z M115.16,51.52h-5.71 c-0.11,0.19-0.23,0.36-0.37,0.52l3.93,3.93C114.08,54.73,114.84,53.21,115.16,51.52L115.16,51.52z M41.6,9.27 c1.16,0.42,1.71,1.57,1.05,2.98c-0.89,1.89-1.88,1.83-3.69,2.29l-1.15,0.29c-1.47,0.4-2.66,0.39-3.49,0.11l-1.04,0.22l-1,2.16 c4.1,1,7.87-0.59,11.39-4.15c5.05-0.79,9.93-0.31,14.59,1.87c0.42,4.29,1.72,7.56,3.73,10c6.25,7.56,17.94,6.94,25.7,2.07 c3.65-2.29,6.66-5.57,9.07-9.76c5.34-0.02,10.62,0.28,15.8,1.1l1.54,3.51C94.89,22.22,83.5,35.66,78.98,56.6H45.08 c-2.27-13.18-8.66-21.8-17.72-27.47l2.47,1.8l-1.69,3.92c5.21,2.93,8.73,8.5,8.73,14.9c0,9.43-7.65,17.08-17.08,17.08 S2.71,59.19,2.71,49.75c0-8.35,6-15.31,13.92-16.79c-4.53,0.49-9.71,2.11-15.43,4.66L0,35.32c5.1-4.62,12.93-7.45,24.42-7.88 c-3.85-2.03-8.11-3.61-12.68-4.85C17.25,11.86,24.28,4.01,33.35,0l1.32,2.19c-3.04,3.46-5.5,7.68-7.35,12.72 c0.8,0.57,1.59,1.05,2.36,1.43l1.39-2.98c0.21-0.44,0.62-0.73,1.07-0.79l0.96-0.2c0.04-0.1,0.1-0.21,0.16-0.32 c0.95-1.68,2.9-2.1,4.77-2.49C39.18,9.35,40.47,8.86,41.6,9.27L41.6,9.27z M110.49,23.7l3.55-0.49l8.46,8.9l-2.24,0.78L110.49,23.7 L110.49,23.7z M105.8,32.67c9.43,0,17.08,7.65,17.08,17.08c0,9.43-7.65,17.08-17.08,17.08c-8.18,0-15.02-5.76-16.69-13.44 l-6.08,0.56c0.77-4.4,2.23-8.49,4.22-12.33l3.06,0.92C93.03,36.71,98.94,32.67,105.8,32.67L105.8,32.67z" />
                    </g>
                  </svg>
                </div>
                <label for="product" class="radio-tile-label">PRODUCT</label>
              </div>
            </div>

            <div class="input-container">
              <input id="spare" class="radio-button" type="radio" name="isSpare" (click)="changeSearchIsSpare(true)" />
              <div class="radio-tile">
                <div class="icon spare-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" shape-rendering="geometricPrecision"
                    text-rendering="geometricPrecision" image-rendering="optimizeQuality" fill-rule="evenodd"
                    clip-rule="evenodd" viewBox="0 0 512 509.77">
                    <path
                      d="M244.48 209.89c1.8 18.05-22.84 51.63-33.52 62.51-21.3 21.66-40.94 45.37-73.68 69.79-23.43 17.47-29.49 19.61-57.67 19.22l-1.02-.05c-10.72 0-21.43 2.45-31.23 7.36l-14.85-14.85c-1.98-1.98-5.21-1.98-7.18 0L1.48 377.7c-1.97 1.99-1.97 5.22 0 7.2l14.79 14.78a69.844 69.844 0 0 0-7.46 30.47l-.04 1.04c0 17.86 6.81 35.74 20.44 49.36 13.58 13.58 31.43 20.39 49.35 20.42h.06c10.81 0 21.61-2.5 31.47-7.47l14.78 14.79c1.98 1.97 5.21 1.97 7.19 0l23.84-23.85c1.98-1.97 1.98-5.19 0-7.18l-14.85-14.85c4.91-9.8 7.36-20.51 7.36-31.23 0-29.62 1.48-35.84 20.2-60.62 24.44-32.39 47.49-50.85 68.75-71.76 10.86-10.68 44.46-33.54 62.5-33.53l-55.38-55.38zM355.29.95c70.35 38.85 119.62 87.62 155.76 155.77 1.01 1.87 1.5 3.96 0 5.46l-17.61 17.61L332.22 18.56 349.83.95c1.5-1.5 3.61-1.01 5.46 0zm11.67 144.1c12.77 12.78 12.77 33.49-.01 46.27-12.77 12.77-33.48 12.78-46.26 0-12.78-12.78-12.78-33.5 0-46.27 12.78-12.78 33.49-12.78 46.27 0zm114.96 46.27-10.68 10.67L310.01 40.77l10.68-10.68 161.23 161.23zm-22.21 22.2L357.59 315.65c-1.47 1.46-3.98 1.46-5.46-.01l-24.44-24.45 5.73-5.74c13.43-13.43.19-17.84-13.19-31.23l-62.43-62.43c-13.39-13.38-17.86-26.58-31.24-13.2l-5.74 5.74-24.46-24.45c-1.47-1.48-1.5-3.96 0-5.46L298.48 52.29l161.23 161.23zm-354.15 217.6c0 14.68-11.9 26.59-26.59 26.59-14.68 0-26.58-11.91-26.58-26.59 0-14.69 11.9-26.59 26.58-26.59 14.69 0 26.59 11.9 26.59 26.59z" />
                  </svg>
                </div>
                <label for="spare" class="radio-tile-label">SPARE PART</label>
              </div>
            </div>



          </div>
        </div>
        <!-- <div class="options">
          <h2>Search<br></h2>
          <h5>Select Product or Spare <br></h5>
          <input name="isSpare" type="radio" id="product" class="hide" checked (click)="changeSearchIsSpare(false)">
          <label for="product">Product</label>


          <input name="isSpare" type="radio" id="spare" class="hide" ngModel (click)="changeSearchIsSpare(true)">
          <label for="spare">Spare Part</label>
        </div> -->
        <p></p>
        <div class="form-group">
          <h5 for="name">Search by keyowrd</h5>
          <input type="text" class="form-control" id="search" (change)="SearchProduct($event)" placeholder="keyword...">
        </div>
        <p></p>
      </div>
      <div style="   overflow: auto;">
        <div *ngFor="let product of products" class="cards_area">



          <div class="card" style="    width: 200px; margin-left: 25px; margin-bottom: 25px;">

            <div class="bg-image hover-overlay" mdbRipple rippleColor="light">
              <img [src]="url + product.img" class="img-fluid" style="max-width: 100% !important; " />
              <a href="#!">
                <div class="mask" style="background-color: rgba(251, 251, 251, 0.15);"></div>
              </a>
            </div>
            <div class="card-body">
              <h5 class="card-title">{{product.name}} - {{product.nameAR}}</h5>
              <p class="card-text">description :{{product.description}}</p>
              <p class="card-text" *ngIf="product.isSpare"> spare for :{{product.spareForProducts}}</p>
              <a class="btn btn-primary" *ngIf=" this.SelectedProductId  != product.id"
                (click)="selectProductEvent(product)"
                style="  color: white !important;     margin-bottom: 5px">Select</a>
              <a class="btn btn-primary" *ngIf=" this.SelectedProductId  == product.id"
                (click)="selectProductEvent(product)"
                style="  color: black !important; background-color: gray;     margin-bottom: 5px">Selected</a>
              <!-- <a class="btn btn-primary" (click)="routeTo('Product/details/'+product.id)"
              style="  color: white !important;">More Details</a> -->
            </div>
          </div>
        </div>


        <!-- <div class="ng-autocomplete" style="width: auto !important;">


        <ng-autocomplete class="form-control" [data]="data" [searchKeyword]="keyword" placeholder="Select Product"
          (selected)='selectProductEvent($event)' (inputChanged)='onChangeSearch($event)'
          (inputFocused)='onFocused($event)' [itemTemplate]="itemTemplate" (inputCleared)="closeSelectedProduct()"
          [notFoundTemplate]="notFoundTemplate">
        </ng-autocomplete>

        <ng-template #itemTemplate let-item>
          <a [innerHTML]="item.name"></a>
        </ng-template>

        <ng-template #notFoundTemplate let-notFound>
          <div [innerHTML]="notFound"></div>
        </ng-template> -->
      </div>


      <br>
      <div class="row" *ngIf="SelectedProductId && newBatchProduct.productId > 0">
        <dt class="col-sm-1">Count :</dt>
        <dd class="col-sm-2"><input type="number" value="1" #count="ngModel" min="1" max="1000" ngModel
            class="form-control" (change)="addCount($event)"></dd>

        <dt class="col-sm-1">Price :</dt>
        <dd class="col-sm-2"> <input type="number" value="0" min="1" max="100000000" class="form-control" id="price"
            name="price" (change)='addPrice($event)'></dd>


        <dt class="col-sm-2"><button style="background-color: green;" class="btn btn-primary" (click)="addProduct()">Add
            Product</button></dt>
      </div>

    </div>
    <hr>
    <table class='table table-striped' aria-labelledby="tableLabel" *ngIf="batchProducts.length">
      <thead>
        <tr>

          <th>Product Name</th>
          <th>Product Name AR</th>
          <th>Count</th>
          <th>Price</th>
          <th>Total Amount</th>


          <th></th>

        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let batchProduct of batchProducts">

          <td>{{batchProduct.product.name}}</td>
          <td>{{batchProduct.product.nameAR}}</td>
          <td>{{batchProduct.count}}</td>
          <td>{{batchProduct.price}}</td>
          <td>{{(batchProduct.price * batchProduct.count) }}</td>

          <td><button style="color: red;" (click)="deleteProduct(batchProduct.productId)">delete</button></td>


        </tr>
        <tr>
          <td>Total</td>
          <td></td>
          <td>{{batchProducts.length}}</td>
          <td>{{totalAmount}}</td>
          <td></td>

          <td></td>

        </tr>
      </tbody>
    </table>
  </div>
  <button type="submit" class="btn btn-primary" *ngIf="batchProducts.length">New Batch</button>
</form>